{% if section.settings.enable %}
  {%- capture alignContent -%}
    {% case section.settings.alignment %}
      {% when 'left' %}
        hero-main--left
      {% else %}
        hero-main--center
    {% endcase %}
  {%- endcapture -%}

  {%- assign postCounter = section.settings.post_count -%} 
  {%- capture postCounterClass -%}
    grid__item small--one-half
    {% case postCounter %}
      {% when '2' %}
        medium-up--one-half
      {% when '3' %}
        medium-up--one-third
      {% when '4' %}
        medium-up--one-quarter
      {% when '5' %}
        medium-up--one-fifth          
      {% when '6' %}
        medium-up--one-third
      {% when '8' %}
        medium-up--one-quarter
      {% else %}
        medium-up--one-whole
    {% endcase %}
  {%- endcapture -%}

  <div class="page-width">
   
    <div class="{{ alignContent }}
      {% if section.settings.text_color == 'white' %}hero-main--white{% endif %}
      {% if section.settings.margin_bottom == 'margin' %}section-margin-bottom{% endif %}">

      <div class="copy-main__wrapper {% if section.settings.alignment == 'left' %}grid {%endif %}">

        <div class="{% if section.settings.alignment == 'left' %} medium-up--one-third grid__item {% endif %}">
          {% if section.settings.subtitle != blank %}
            <h3 class="h6 uppercase">{{section.settings.subtitle}}</h3>
          {% endif %}
          {% if section.settings.title != blank %}
            <h2 class="h1 hero-title  ">{{ section.settings.title | escape }}</h2>
          {% endif %}
        </div>
        
          <div class="{% if section.settings.alignment == 'left' %} medium-up--two-thirds grid__item {% endif %}">
            <div class="margin-auto hero-text rte-setting ">
            {% if section.settings.text != blank %}{{ section.settings.text }}{% endif %}
            {% if section.settings.button_label != blank and section.settings.button_link != blank %}
              <a href="{{ section.settings.button_link }}" class="button button--white">
                {{ section.settings.button_label }}
              </a>
            {% endif %}
            </div>
          </div>
      </div>
    </div>

  {%- assign blog = blogs[section.settings.blog] -%}

  {% unless blog.articles_count == 0 %}
  <div class="{% if section.settings.margin_bottom == 'margin' %}section-margin-bottom{% endif %}">
    <div class="grid">
      {% for article in blog.articles limit: postCounter %}
          {% include 'featured-posts'  with gridWidth: postCounterClass %}
      {% endfor %}
    </div>
  </div>
  {% endunless %}

  </div>
  
{% endif %}
 
{% schema %}
  {
    "name": "Blog Posts",
    "class": "index-section index-section--flush",
    "settings": [
      {
        "type": "checkbox",
        "id": "enable",
        "label": "Show section"
      },
      {
        "type": "select",
        "id": "margin_bottom",
        "label": "Margin bottom",
        "default": "no-margin",
        "options": [
          {
            "label": "Margin bottom",
            "value": "margin"
          },
          {
            "label": "No margin",
            "value": "no-margin"
          }
        ]
      },
      {
        "type": "select",
        "id": "alignment",
        "label": "Text alignment",
        "default": "center",
        "options": [
          {
            "value": "left",
            "label": "Left"
          },
          {
            "value": "center",
            "label": "Center"
          }
        ]
      },
      {
        "type": "text",
        "id": "title",
        "label": "Heading",
        "default": "Image with text overlay"
      },    
      {
        "type": "text",
        "id": "subtitle",
        "label": "Subheading",
        "default": "Featured Articles"
      },   
      {
        "type": "richtext",
        "id": "text",
        "label": "Text",
        "default": "<p>Use overlay text to give your customers insight into your brand. Select imagery and text that relates to your style and story.</p>"
      },
      {
        "type":"blog",
        "id":"blog",
        "label":"Blog to pull posts from"
      },
      {
        "type": "select",
        "id": "post_count",
        "label": "Number of posts to show",
        "default": "3",
        "options": [
          {
            "value": "2",
            "label": "2"
          },
          {
            "value": "3",
            "label": "3"
          },
          {
            "value": "4",
            "label": "4"
          },
          {
            "value": "5",
            "label": "5"
          },          
          {
            "value": "6",
            "label": "6"
          },
          {
            "value": "8",
            "label": "8"
          }
        ]
      },
      {
        "type": "text",
        "id": "button_label",
        "label": "Button label"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button link"
      }
    ],
    "presets": [
      {
        "name": "Blog Posts",
        "category": "Misc"
      }
    ]
  }
{% endschema %}