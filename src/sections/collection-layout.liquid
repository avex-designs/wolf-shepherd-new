{% comment %}
  modules/.scss
{% endcomment %}
{%- assign collectionCounter = section.settings.product_per_row -%} 
{%- capture collectionCounterClass -%}
  grid__item small--one-half
  {% case collectionCounter %}
    {% when '2' %}
      medium-up--one-half
    {% when '3' %}
      medium-up--one-third
    {% when '4' %}
      medium-up--one-quarter
    {% else %}
      medium-up--one-whole
  {% endcase %}
{%- endcapture -%}

{% assign collectionCount = section.settings.product_per_page | plus: 0  %}

{% paginate collection.products by collectionCount %}

  {% if section.settings.enable and collection.image %}
    {% include 'hero-image' with type: 'collection' %}
  {% else %}
    <div class="page-width">
      <h1 class="collection__header text-center">{{ collection.title }}</h1>
    </div>
  {% endif %}

  {% if section.settings.linklist != blank %}
    <div class="collection-navigation">
      <div class="page-width">
        <ul>
        {% for link in linklists[section.settings.linklist].links %}
          <li class="collection-navigation__item {% if link.active %}collection-navigation__link--active{% endif %}">
            <a class="collection-navigation__link" href="{{ link.url }}">
              {{ link.title }}
            </a>
          </li>
        {% endfor %}
        </ul>
      </div>
    </div>
  {% endif %}

  <div class="collection-wrapper">
    <div class="page-width">

      <div class="grid">
        <div class="grid__item medium-up--one-quarter">
          {% include 'collection-sidebar' %}
        </div>
        <div class="grid__item medium-up--three-quarters">

        <div class="grid">
          {% for product in collection.products %}

            {% include 'collection-grid-product' with gridWidth: collectionCounterClass  %}

            {% if forloop.index == 10 %}

              {% comment %} <div class="grid__item collection-grid-item__match-height medium-up--two-thirds">            
                {% include 'newsletter'  %}
              </div> {% endcomment %}
            {% endif %}

            {% if collection.handle == 'all' and collection.all_vendors.size == 0 and collection.all_types.size == 0 %}
              <p>{{ 'collections.general.no_matches' | t }}</p>
              {% break %}
            {% endif %}
            
          {% endfor %}
        </div>

        </div></div>

    </div>
  </div>

  {% if paginate.pages > 1 %}
  <div class="page-width text-center">
    {% include 'pagination' %}
  </div>
  {% endif %}
{% endpaginate %}

{% schema %}
  {
    "name": "Collection Layout",
    "settings": [
      {
        "type": "header",
        "content": "Collection hero image"
      },
      {
        "type": "checkbox",
        "id": "enable",
        "label": "Show section",
        "default": true
      },
      {
        "type": "select",
        "id": "margin_bottom",
        "label": "Margin bottom",
        "default": "no-margin",
        "options": [
          {
            "label": "Margin bottom",
            "value": "section-margin-bottom"
          },
          {
            "label": "No margin",
            "value": "no-margin"
          }
        ]
      },
      {
        "type": "select",
        "id": "full-width",
        "label": "Full width",
        "default": "full-width",
        "options": [
          {
            "label": "Full width",
            "value": "full-width"
          },
          {
            "label": "Within wrapper",
            "value": "wrapper"
          }
        ]
      },
      {
        "type": "select",
        "id": "positionX",
        "label": "Text position horizontal",
        "default": "hero-image--center",
        "options": [
          {
            "value": "hero-image--left",
            "label": "Left"
          },
          {
            "value": "hero-image--center",
            "label": "Center"
          },
          {
            "value": "hero-image--right",
            "label": "Right"
          }
        ]
      },
      {
        "type": "select",
        "id": "positionY",
        "label": "Text position vertical",
        "default": "hero-image--middle",
        "options": [
          {
            "value": "hero-image--top",
            "label": "Top"
          },
          {
            "value": "hero-image--middle",
            "label": "Middle"
          },
          {
            "value": "hero-image--bottom",
            "label": "Bottom"
          }
        ]
      },
      {
        "type": "select",
        "id": "alignment",
        "label": "Text alignment",
        "default": "hero-image--text-center",
        "options": [
          {
            "value": "hero-image--text-left",
            "label": "Left"
          },
          {
            "value": "hero-image--text-center",
            "label": "Center"
          },
          {
            "value": "hero-image--text-right",
            "label": "Right"
          }
        ]
      },
      {
        "type": "select",
        "id": "text_color",
        "label": "Text colour",
        "default": "hero-image--black",
        "options": [
          {
            "label": "White",
            "value": "hero-image--white"
          },
          {
            "label": "Black",
            "value": "hero-image--black"
          }
        ]
      },
      {
        "type": "header",
        "content": "Mobile only settings"
      },
      {
        "type": "select",
        "id": "mobile_text_position",
        "label": "Mobile text position",
        "default": "hero-image--mobile-text-overlay",
        "options": [
          {
            "label": "Text under",
            "value": "hero-image--mobile-text-under"
          },
          {
            "label": "Text overlay",
            "value": "hero-image--mobile-text-overlay"
          }
        ]
      },


      {
        "type": "header",
        "content": "Collection Settings"
      },
      {
        "type": "link_list",
        "id": "linklist",
        "label": "Navigation"
      }, 
      {
        "type": "number",
        "id": "product_per_page",
        "label": "Number of products per page"
      },
      {
        "type": "select",
        "id": "product_per_row",
        "label": "Number of products per row",
        "default": "3",
        "options": [
          {
            "value": "2",
            "label": "2"
          },
          {
            "value": "3",
            "label": "3"
          },
          {
            "value": "4",
            "label": "4"
          }
        ]
      },
      {
        "type": "checkbox",
        "id": "show_excerpt",
        "label": "Show product excerpt",
        "default": true
      },
      {
        "type": "select",
        "id": "product-text-alignment",
        "label": "Product text alignment",
        "default": "center",
        "options": [
          {
            "value": "left",
            "label": "Left"
          },
          {
            "value": "center",
            "label": "Center"
          },
          {
            "value": "right",
            "label": "Right"
          }
        ]
      },

      

      {
        "type": "header",
        "content": "Collection Newsletter"
      },
       {
        "type": "checkbox",
        "id": "show_newsletter",
        "label": "Show newsletter signup",
        "default": true
      },
      {
        "type": "image_picker",
        "id": "newsletter-image",
        "label": "Newsletter Image Background"
      },
      {
        "type": "text",
        "id": "newsletter-title",
        "label": "Newsletter title"
      },
      {
        "type": "text",
        "id": "newsletter-text",
        "label": "Newsletter text"
      },
      {
        "type": "select",
        "id": "newsletter_text_color",
        "label": "Text colour",
        "default": "black",
        "options": [
          {
            "label": "White",
            "value": "white"
          },
          {
            "label": "Black",
            "value": "black"
          }
        ]
      }
    ],
    "blocks": [
      {
        "type": "filter-group",
        "name": "Filter Group",
        "settings": [
          {
            "label": "Title for filter group",
            "id": "filter-group-title",
            "type": "text"
          },
          {
            "label": "Comma separated tag list",
            "id": "tag-list",
            "type": "textarea"
          }
        ]
      }
    ]
  }

{% endschema %}
